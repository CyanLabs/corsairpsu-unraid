Menu="Dashboard"
Icon="ups"
---
<style type="text/css">
	.dash_corsairpsu_toggle {display:none;}	
	.dash_corsairpsu_header {padding-top: 20px}	
	.dash_corsairpsu_section {
		line-height:1.4em !important;
		margin-left:-4px !important;
	}
	.dash_corsairpsu_table_header {text-decoration:underline;}
</style>

<table id="db-box1" class="dash_corsairpsu dashboard box1" style="display:none">
    <thead sort="965" class="sortable">
        <tr>
            <td></td>
            <td class="next dash_corsairpsu_header" colspan="3">
                <i class="icon-ups"></i>
                <div class="section dash_corsairpsu_section">Power Supply
                    <br>
                    <span id="corsair-vendor"></span> <span id="corsair-product"></span> (<span id="corsair-capacity"></span>W)
                    <span id="util">Utilization: <span id="corsair-load"></span>% (<span id="corsair-watts"></span>W)</span>
                    </span>
                    <br>
                </div>
                <i class="fa fa-fw chevron mt0" id="dash_corsairpsu_toggle" onclick="toggleChevron('dash_corsairpsu_toggle',0)"></i>
            </td>
            <td></td>
        </tr>
    </thead>
    <tbody class="dash_corsairpsu_toggle sortable" sort="965">
        <tr>
            <td></td>
            <td><span class="header dash_corsairpsu_table_header">12v Utilization</span></td>
            <td><span class="header dash_corsairpsu_table_header">5v Utilization</span></td>
            <td><span class="header dash_corsairpsu_table_header">3v Utilization</span></td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td><span id="corsair-12v_load"></span>% (<span id="corsair-12v_watts"></span>W) </td>
            <td><span id="corsair-5v_load"></span>% (<span id="corsair-5v_watts"></span>W)</td>
            <td><span id="corsair-3v_load"></span>% (<span id="corsair-3v_watts"></span>W)</td>
            <td></td>
        </tr>
        <tr>
            <td></td>
        </tr>
        <tr>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td>Temperature / Fan</td>
            <td><span id="corsair-temp1"></span> / <span id="corsair-temp2"></span> Â°c</td>
            <td><span id="corsair-fan_rpm"></span> RPM</td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td>Uptime</td>
            <td><span id="corsair-uptime"></span></td>
            <td><span id="corsair-poweredon"></span> Total</td>
            <td></td>
        </tr>
    </tbody>
</table>

<script>
const corsairpsu_status = () => {
 $.getJSON("/plugins/corsairpsu/status.php", (data) => {
  if(data) {
	$.each(data, function (key, data) {
		$("#corsair-"+key).html(data);
    })
  }
<?if ($update):?>
  setTimeout(corsairpsu_status, <?=max(abs($display["refresh"]),2000)?>);
<?endif;?>
 });
};
$(corsairpsu_status);

$(function() {
  // append data from the table into the correct one
  $("#db-box1").append($(".dash_corsairpsu").html());
  
  // reload toggle to get the correct state
  toggleView('dash_corsairpsu_toggle',true);
  
  // reload sorting to get the stored data (cookie)
  sortTable($('#db-box1'),$.cookie('db-box1'));
});
</script>